# Standaard rapportage uitdraaien

## Data klaarzetten en samenvoegen

TODO. 
  
> Zodra data 2024 binnen is procedure beschrijven om data in map te zetten en samen te voegen.

## Configuratie in frontmatter

De eigenschappen van Quarto documenten kunnen bovenaan in de *YAML* *frontmatter* ingesteld worden.
In het voorbeeld hieronder wordt een inhoudsopgave ingesteld met de titel "Inhoudsopgave" en aan de rechterkant van het document geplaatst. 

```yaml
---
toc: true
toc-location: right
toc-title: "Inhoudsopgave"
---
```

Om de standaardrapportage met eigen data uit te draaie    n moeten enkele aanpassingen gedaan worden in de frontmatter.

TODO

> Zodra data 2024 binnen is naam bestand rapprotage qmd aanpassen & voorbeeld frontmatter bijwerken
> Voorlopig met voorbeeld_rapportage.qmd

Open **voorbeeld_rapportage.qmd**. Daar zie je de volgende frontmatter staan:

```yaml
---
title: ""
author: ""
format:
  html:
    page-layout: full
    css: custom.css
    toc: TRUE
    toc-location: left
    embed-resources: true
params:
  gemeentecode: 2 
  regiocode: 23
  regionaam: 'GGD Limburg-Noord'
  path_monitor_data: "../nep testdata GMJV - Regionaal trendbestand 2022-2024.sav"
  path_hulpfuncties: "../hulpfuncties.R"
  path_cbs_data: "../JongVolWassenenNaarGeslachtEnLeeftijd1Jan2024.xlsx"
  default_nvar: 100
  default_ncel: 10
  default_kleuren_grafiek: !expr c("#012C17","#76B82A","#007E48")
  default_kleuren_responstabel: !expr c("header" = "#012C17", "kleur_1" = "#007E48", "kleur_2" = "#76B82A","kleur_tekst" = "#FFFFFF")
format-links: false
---
```

De meeste instellingen kan je laten staan. Het volgende moet aangepast of gecontroleerd worden:

-   **gemeentecode:** Voer hier een gemeentecode in die bestaat in je data. Dit is als het ware je voorbeeldgemeente. Als je het rapport uitdraait via de "Render" knop zal een rapport voor die gemeente gemaakt worden.
-   **regiocode:** voer hier de CBS code van je GGD-regio in.
-   **regionaam:** voer hier de Naam van je GGD-regio in.
-   **path_..:** voer hier de bestandsnamen van alle databestanden in
-   **default_nvar:** voer hier het algemene minimum aantal respondenten per vraag in
-   **default_ncel:** voer hier het algemene minimum aantal respondenten per antwoord in
-   **default_kleuren_grafiek:** Voer hier een vector in met de standaard kleurcodes voor grafieken. 
-   **default_kleuren_responstabel:** Voer hier een vector in met de standaard kleurcodes voor responstabellen


## Rapporten per gemeente uitdraaien
Als je het rapport uitdraait door op de "Render" knop te drukken wordt er één rapport gemaakt dat is ingesteld op de gemeentecode in de *frontmatter*. Dit is handig om eventuele wijzigingen in het rapport te testen. Als je rapporten voor alle gemeenten wilt uitdraaien volg je de volgende stappen

TODO

> Zodra data 2024 binnen is stappen aanpassen
> Voorlopig met voorbeeld_rapportage.qmd

-   Open **maak_rapport_per_gemeente.R**
-   Controleer of de variabelen **file_path** en **regiocode** goed staan ingesteld
-   Draai de rest van de code.

Het script gaat met een *loop* langs alle gemeentecodes en maakt voor iedere gemeente een rapport.


## PDF uitdraai en Printbaarheid

Op verzoek is het mogelijk gemaakt de rapportage als PDF op te slaan en te zorgen dat deze printbaar is. De eerste stap hiervoor is bedenken of het wel nodig is om het rapport te printen. Meestal is dat niet zo. Als het toch nodig blijkt volg je de onderstaande stappen.

### Pagina-einden bepalen d.m.v. "Header 1"

In een browser bestaan pagina's niet echt. De standaard html-uitvoer van het rapport heeft dan ook geen pagina's. Wanneer je een rapport gaat printen zijn pagina-einden wel belangrijk. Daarom is voor deze rapportage ingesteld dat pagina-einden altijd vóór een kop van niveau 1 vallen.

Let daarom goed op dat je alleen een kop van niveau 1 maakt als je een nieuwe pagina wilt beginnen.

::: callout-warning
Controleer altijd de pdf-uitvoer op het mooi overlopen van pagina's

Er zijn grenzen aan hoe veel er op één pagina past. Als je te veel grafieken of tekst onder een header van niveau 1 plaatst, zal alles wat niet past naar de volgende pagina gaan. Te veel inhoud onder één header kan dus alsnog voor een arbitraire overgang van paginas zorgen.
:::

::: {.callout-tip title="Aangepaste eigenschappen Header 1" collapse="true"}
Headers van niveau 1 krijgen voor de GMJV rapportage standaard een gekleurde achtergrond en beginnen (bij conversie naar pdf) altijd op een nieuwe pagina.

Dit zijn aangepaste eigenschappen die worden bepaald in het CSS-bestand "custom.css". Je kan deze eigenschappen in dat bestand uitzetten of wijzigen. Zie ook het hoofdstuk [CSS](css.qmd)
:::

### PDF uitdraaien

Als de pagina-einden goed ingesteld staan kan je de rapportage als PDF bestand uitdraaien. Let hierbij op dat je ten minste Google Chrome 128 hebt. Zie daarvoor ['PDF-uitdraai' in het hoofdstuk 'Beginnen'](beginnen.qmd#voor-pdf-uitdraai)

-   Open het bestand **maak_pdf_rapport.R**
-   Controleer of de variabelen **file_path**, **regiocode** goed staan ingesteld.
-   Draai het hele script.
-   Controleer de uitvoer.
