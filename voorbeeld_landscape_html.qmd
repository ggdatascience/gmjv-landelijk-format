---
title: ""
author: ""
format:
  html:
    page-layout: full
    css: custom.css
    toc: TRUE
    toc-location: left
    embed-resources: true
editor: visual
---

```{r, echo=F, message=F}
library(gt)
library(dplyr)
library(ggplot2)
library(tidyr)
library(haven)
library(labelled)
options(dplyr.summarise.inform = FALSE)
source("hulpfuncties.R")

# Links naar dingen IN het document maken (maakt dat uit als we een TOC hebben? Misschien voor PDF?)
#https://quarto.org/docs/authoring/cross-references-custom.html


#TODO Hier later SPSS data inlezen
#Nu nepdata genereren 

#SPSS data inlezen
file_path = "nep testdata GMJV - Regionaal trendbestand 2022-2024.sav"


monitor_df = haven::read_spss(file_path,user_na =T) %>%
  labelled::user_na_to_na()

#Vreselijke varcodes hernoemen naar iets anders vreselijs
names(monitor_df) <- c("jaar","standaardisatiefactor","leeftijd_3cat","leeftijd_2cat","gender_3cat","gender_2cat","ggd_regio","ggd_regio_utrecht_samen","gemeentecode","stedelijkheid","migratie_3cat","opleiding","opleiding_4cat","opleiding_3cat","opleiding_2cat","ervaren_gezondheid_goed","psychische_klachten", "tevreden_zelf_3cat","tevreden_lichaam_3cat","tevreden_leven_3cat","vaak_stress","vertrouwen_toekomst_3cat","bezorgd_werkgelegenheid","bezorgd_woningmarkt","bezorgd_klimaat","bezorgd_discriminatie","bezorgd_polarisatie","bezorgd_oorlogen","eenzaamheid_3cat","is_eenzaam","sterk_eenzaam","prestatiedruk")



#Er is niet goed aangegeven wat missing is in SPSS.
#tijdelijke functie om 9 Onbekend te verwijderen & naar NA te zetten



for(var in names(monitor_df)){
  
  monitor_df <- monitor_df %>% verwijder_9_onbekend(var)

}

#TODO Afhankelijk van keuze werkgroep nog met survey:: conf. intervals & gewogen aantallen uitrekenen. 
```

\

::: voorblad_achtergrond
![](voorblad_alles.png)

::: voorblad_gemeentenaam
Rapportnaam
:::

::: voorblad_datum
`r Sys.Date()`
:::
:::

{{< pagebreak >}}

::: pagina_header_img
![](header_pagina.png)

::: pagina_header_titel
# 1. Toelichting
:::
:::

**Afname Gezondheidsmonitor Jeugd 2023**

De Gezondheidsmonitor Jeugd is in het najaar van 2023 afgenomen onder jongeren in leerjaar 2 en 4 van het RVO. Op de volgende paginaâ€™s zijn de belangrijkste resultaten van uw gemeente afgezet tegen het gemiddelde van uw GGD regio.

Vanwege de betrouwbaarheid van de resultaten en de privacy van de respondenten hanteren wij bij de rapportage een minimum van 30 respondenten die de vraag ingevuld hebben en een minimum van 5 respondenten per specifiek antwoord. Indien de aantallen lager liggen, worden de cijfers niet weergegeven.

```{r, echo=F}


monitor_df %>% 
  maak_responstabel(crossings = c("gender_2cat","leeftijd_3cat"),
                    missing_label = "Niet ingevuld"
                    )

```

{{< pagebreak >}}

::: pagina_header_img
![](header_pagina.png)

::: pagina_header_titel
# 2. School
:::
:::

::: {layout="[[30,30,30],[30,30,30]]"}
::: column
Jongeren brengen een groot deel van hun tijd door op school. Op school doen jongeren kennis en vaardigheden op die belangrijk zijn voor hun ontwikkeling. Maar ook doen ze sociale contacten op en maken ze vrienden. Wanneer jongeren worden gepest, kan dit negatieve gevolgen hebben voor hun sociaal-emotionele gezondheid. In de monitor is gevraagd naar de schoolbeleving, ziekteverzuim, spijbelen en pesten.
:::

::: column
```{r, echo=F}
monitor_df %>% 
   maak_staafdiagram_dubbele_uitsplitsing(
     var_inhoud = "vaak_stress", 
     var_crossing_groep = "gender_2cat",
     var_crossing_kleur = "leeftijd_2cat",
     titel = "STRESS!")

```
:::

::: column
```{r, echo=F}
monitor_df %>% 
   maak_staafdiagram_dubbele_uitsplitsing(
     var_inhoud = "vaak_stress", 
     var_crossing_groep = "gender_2cat",
     var_crossing_kleur = "leeftijd_3cat",
     titel = "SPORT?")
```
:::

::: column
```{r, echo=F}
monitor_df %>% maak_staafdiagram_vergelijking(
  var_inhoud = "is_eenzaam",
  var_crossings = "gender_2cat",
  titel = "Eenzaam",
  kleuren_grafiek = c("#009898","#E8525F")
  
)
```
:::

::: column
```{r, echo=F}
monitor_df %>% 
   maak_staafdiagram_dubbele_uitsplitsing(
     var_inhoud = "bezorgd_klimaat", 
     var_crossing_groep = "leeftijd_3cat",
     var_crossing_kleur = "gender_2cat",
     titel = "Zorgen over klimaat?")
```
:::

::: column
```{r, echo=F}
monitor_df %>% maak_staafdiagram_vergelijking(
  var_inhoud = "vaak_stress",
  var_crossings = c("gender_2cat","leeftijd_2cat"),
  titel = "meer stress")
```
:::
:::

{{< pagebreak >}}

```{r}
#Staafdiagram met dubbele uitsplitsing
monitor_df %>% 
   maak_staafdiagram_dubbele_uitsplitsing(
     titel = "Staafdiagram met dubbele uitsplitsing",
     var_inhoud = "vaak_stress", 
     var_crossing_groep = "gender_2cat",
     var_crossing_kleur = "leeftijd_2cat")


```

```{r}
monitor_df %>% maak_staafdiagram_vergelijking(
  var_inhoud = "is_eenzaam",
  var_crossings = c("gender_2cat"),
  titel = "SPIJBELEN",
  #Je kan de kleuren zelf aanpassen als je wilt
  kleuren_grafiek = c("#009898","#E8525F")
)
```

```{r}
#Kan ook voor meerdere vergelijkingen naast elkaar gebruikt worden
monitor_df %>% maak_staafdiagram_vergelijking(
  var_inhoud = "bezorgd_oorlogen",
  var_crossings = c("gender_2cat","leeftijd_2cat"),
  titel = "Zorgen over oorlog",
  #Je kan de kleuren zelf aanpassen als je wilt
  kleuren_grafiek = c("#009898","#E8525F")
)
```

```{r}
monitor_df %>% 
  maak_staafdiagram_meerdere_staven(
    var_inhoud = "tevreden_lichaam_3cat",
    titel = "Tevreden over Lichaam"
  )
```

```{r}

monitor_df %>% 
  maak_staafdiagram_meerdere_staven(
    var_inhoud = "tevreden_lichaam_3cat",
    var_crossing = "leeftijd_2cat",
    titel = "Tevreden over Lichaam"
  )
```

```{r}
monitor_df %>% 
  maak_staafdiagram_meerdere_staven(
    var_inhoud = "tevreden_lichaam_3cat",
    var_crossing = "leeftijd_2cat",
    titel = "Tevreden over Lichaam",
    flip = TRUE
  )
```

```{r}

```
